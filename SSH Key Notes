A. Generate SSH Key on EC2 (Ubuntu)

SSH into your EC2 instance:

ssh -i your-ec2-key.pem ubuntu@EC2_PUBLIC_IP


Generate the key:

ssh-keygen -t ed25519 -C "gitlab-ci-ec2"


When prompted:

Enter file in which to save the key: /home/ubuntu/.ssh/gitlab_ci
Enter passphrase:  (PRESS ENTER – leave empty)


Result:

/home/ubuntu/.ssh/gitlab_ci        → PRIVATE KEY
/home/ubuntu/.ssh/gitlab_ci.pub    → PUBLIC KEY

B. Add Public Key to Target Server (EC2)

This is required so GitLab CI can SSH into EC2.

cat ~/.ssh/gitlab_ci.pub >> ~/.ssh/authorized_keys
chmod 600 ~/.ssh/authorized_keys
chmod 700 ~/.ssh


This allows SSH login using the private key.

C. Add PRIVATE Key to GitLab CI/CD Variable
1. Copy private key
cat ~/.ssh/gitlab_ci


Copy everything, including:

-----BEGIN OPENSSH PRIVATE KEY-----
...
-----END OPENSSH PRIVATE KEY-----

2. Add variable in GitLab

In GitLab UI:

Project → Settings → CI/CD → Variables → Add variable